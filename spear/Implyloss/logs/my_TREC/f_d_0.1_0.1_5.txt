Hello 2 1
2021-06-05 19:47:03.826519: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory
2021-06-05 19:47:03.826627: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
WARNING:tensorflow:From /home/parth/.local/lib/python3.8/site-packages/tensorflow/python/compat/v2_compat.py:96: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
Started Reading Flags

checkpoint_load_mode = mru
d_pickle_name = d_processed.p
data_dir = /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC
dropout_keep_prob = 0.8
early_stopping_p = 20
f_d_adam_lr = 0.0003
f_d_batch_size = 16
f_d_class_sampling_str = 10,10,10,10,10,10
f_d_epochs = 7
f_d_metrics_pickle_name = metrics_train_f_on_d.p
f_d_primary_metric = accuracy
f_d_U_adam_lr = 0.0003
f_d_U_batch_size = 32
f_d_U_epochs = 7
f_d_U_metrics_pickle_name = metrics_train_f_on_d_U.p
f_infer_out_pickle_name = infer_f.p
f_layers_str = 512,512
gamma = 0.1
lamda = 0.1
min_rule_coverage = 0
network_dropout = True
num_checkpoints = 1
num_classes = 0
num_load_d = 0
num_load_U = 0
num_load_validation = 0
output_dir = /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/f_d_0.1_0.1_5
rule_classes_str = 
run_mode = f_d
shuffle_batches = True
test_w_batch_size = 1000
U_pickle_name = U_processed.p
use_joint_f_w = False
validation_pickle_name = validation_processed.p
w_infer_out_pickle_name = infer_w.p
w_layers_str = 512,512

Hi1
Ended Reading Flags
Loading from hoff  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/f_d_0.1_0.1_5/d_processed.p
Loading from hoff  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/U_processed.p
Rule classes:  [2, 1, 1, 4, 3, 2, 1, 3, 5, 4, 3, 2, 4, 1, 2, 5, 4, 1, 2, 4, 3, 1, 3, 2, 1, 1, 4, 4, 5, 1, 3, 5, 2, 1, 5, 1, 5, 5, 0, 5, 5, 1, 4, 2, 3, 2, 1, 3, 5, 1, 1, 3, 2, 1, 1, 5, 2, 3, 2, 5, 3, 3, 4, 5, 5, 4, 2, 0]
length of covered U: 4637
Size of d before oversampling:  68
Size of U (covered) :  4637
Size of d after oversampling:  680
Size of d_U after combining:  5317
Loading 68 elements from d
num instances in d:  680
Loading from hoff  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/validation_processed.p
Setting value of d to 0 for test data
test_w len:  476
test_w len:  476
Number of features:  1024
Number of classes:  6
Print num of rules to train:  68
Print num of rules:  68



Found prev best metric for run type f_d: 0.636
best metrics dict:  {'f1_score_1': 0.6575342465753424, 'precision_1': 0.5680473372781065, 'recall_1': 0.7804878048780488, 'support_1': 123, 'f1_score': array([0.61538462, 0.65753425, 0.492891  , 0.73076923, 0.65079365,
       0.65333333]), 'precision': array([0.8       , 0.56804734, 0.52525253, 0.7755102 , 0.78846154,
       0.63636364]), 'recall': array([0.5       , 0.7804878 , 0.46428571, 0.69090909, 0.55405405,
       0.67123288]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.6334510120194727, 'avg_precision': 0.6822725402395733, 'avg_recall': 0.6101615901398728, 'accuracy': 0.636, 'epoch': 31.0, 'f_d_global_step': 1302}
[Errno 2] No such file or directory: '/home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/f_d_0.1_0.1_5/metrics_train_f_on_d_U.p'
Did not find prev best metric for run type f_d_U. Setting to zero.
/home/parth/.local/lib/python3.8/site-packages/tensorflow/python/keras/legacy_tf_layers/core.py:171: UserWarning: `tf.layers.dense` is deprecated and will be removed in a future version. Please use `tf.keras.layers.Dense` instead.
  warnings.warn('`tf.layers.dense` is deprecated and '
/home/parth/.local/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer_v1.py:1719: UserWarning: `layer.apply` is deprecated and will be removed in a future version. Please use `layer.__call__` method instead.
  warnings.warn('`layer.apply` is deprecated and '
WARNING:tensorflow:From /home/parth/.local/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py:201: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /home/parth/.local/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py:201: softmax_cross_entropy_with_logits (from tensorflow.python.ops.nn_ops) is deprecated and will be removed in a future version.
Instructions for updating:

Future major versions of TensorFlow will allow gradients to flow
into the labels input on backprop by default.

See `tf.nn.softmax_cross_entropy_with_logits_v2`.

WARNING:tensorflow:From /home/parth/Desktop/SEM6/RnD/spear/spear/Implyloss/my_model.py:615: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
[
    "<tf.Variable 'global_step:0' shape=() dtype=int64_ref>",
    "<tf.Variable 'f_d_global_step:0' shape=() dtype=int32_ref>",
    "<tf.Variable 'f_network/dense/kernel:0' shape=(1024, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/bias:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/kernel:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/bias:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/kernel:0' shape=(512, 6) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/bias:0' shape=(6,) dtype=float32_ref>",
    "<tf.Variable 'beta1_power:0' shape=() dtype=float32_ref>",
    "<tf.Variable 'beta2_power:0' shape=() dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/kernel/f_d_Adam:0' shape=(1024, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/kernel/f_d_Adam_1:0' shape=(1024, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/bias/f_d_Adam:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/bias/f_d_Adam_1:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/kernel/f_d_Adam:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/kernel/f_d_Adam_1:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/bias/f_d_Adam:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/bias/f_d_Adam_1:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/kernel/f_d_Adam:0' shape=(512, 6) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/kernel/f_d_Adam_1:0' shape=(512, 6) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/bias/f_d_Adam:0' shape=(6,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/bias/f_d_Adam_1:0' shape=(6,) dtype=float32_ref>",
    "<tf.Variable 'f_d_U_global_step:0' shape=() dtype=int32_ref>",
    "<tf.Variable 'w_network/w_layer_0/kernel:0' shape=(1092, 512) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_0/bias:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_1/kernel:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_1/bias:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_linear_layer/kernel:0' shape=(512, 1) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_linear_layer/bias:0' shape=(1,) dtype=float32_ref>"
]
2021-06-05 19:47:08.808220: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-06-05 19:47:08.809051: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-05 19:47:08.810201: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2021-06-05 19:47:08.810237: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2021-06-05 19:47:08.810262: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (parth-G3-3590): /proc/driver/nvidia/version does not exist
2021-06-05 19:47:08.956785: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2021-06-05 19:47:08.989073: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2599990000 Hz
Restoring checkpoint from path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/f_d_0.1_0.1_5/checkpoints/hls-model-2436
Run mode is f_d
training f on d
num_instances:  680
batch_size:  16
total_batch:  42
remaining:  8
total_batch:  42
Optimization started for f_d!
Batch size: 16!
Batches per epoch : 42!
Number of epochs: 7!

========== epoch : 0 ============

cost: 2.1158287360040483e-05

patience: 0


metrics_dict:  {'f1_score_1': 0.6460481099656358, 'precision_1': 0.5595238095238095, 'recall_1': 0.7642276422764228, 'support_1': 123, 'f1_score': array([0.571, 0.646, 0.488, 0.746, 0.661, 0.649]), 'precision': array([0.667, 0.560, 0.538, 0.788, 0.792, 0.617]), 'recall': array([0.500, 0.764, 0.446, 0.709, 0.568, 0.685]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.6270768358136453, 'avg_precision': 0.660240075579563, 'avg_recall': 0.6120410328687976, 'accuracy': 0.636, 'epoch': 59.0, 'f_d_global_step': 2478}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.636 Current is: 0.636

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/f_d_0.1_0.1_5/checkpoints/hls-model-2478

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/f_d_0.1_0.1_5/checkpoints/f_d/best.ckpt-1302


========== epoch : 1 ============

cost: 1.8359101312896767e-05

patience: 1


metrics_dict:  {'f1_score_1': 0.6482758620689655, 'precision_1': 0.562874251497006, 'recall_1': 0.7642276422764228, 'support_1': 123, 'f1_score': array([0.571, 0.648, 0.481, 0.740, 0.661, 0.641]), 'precision': array([0.667, 0.563, 0.521, 0.786, 0.792, 0.613]), 'recall': array([0.500, 0.764, 0.446, 0.700, 0.568, 0.671]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.6237997463838371, 'avg_precision': 0.6568402278999952, 'avg_recall': 0.608242776330815, 'accuracy': 0.632, 'epoch': 60.0, 'f_d_global_step': 2520}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.636 Current is: 0.632

WARNING:tensorflow:From /home/parth/.local/lib/python3.8/site-packages/tensorflow/python/training/saver.py:968: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/f_d_0.1_0.1_5/checkpoints/hls-model-2520

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/f_d_0.1_0.1_5/checkpoints/f_d/best.ckpt-1302


========== epoch : 2 ============

cost: 1.8495058200295757e-05

patience: 2


metrics_dict:  {'f1_score_1': 0.6506849315068493, 'precision_1': 0.5621301775147929, 'recall_1': 0.7723577235772358, 'support_1': 123, 'f1_score': array([0.571, 0.651, 0.476, 0.734, 0.661, 0.653]), 'precision': array([0.667, 0.562, 0.510, 0.784, 0.792, 0.636]), 'recall': array([0.500, 0.772, 0.446, 0.691, 0.568, 0.671]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.6245590253670148, 'avg_precision': 0.6585537578342672, 'avg_recall': 0.6080826383657991, 'accuracy': 0.632, 'epoch': 61.0, 'f_d_global_step': 2562}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.636 Current is: 0.632

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/f_d_0.1_0.1_5/checkpoints/hls-model-2562

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/f_d_0.1_0.1_5/checkpoints/f_d/best.ckpt-1302


========== epoch : 3 ============

cost: 1.4935808275411195e-05

patience: 3


metrics_dict:  {'f1_score_1': 0.6506849315068493, 'precision_1': 0.5621301775147929, 'recall_1': 0.7723577235772358, 'support_1': 123, 'f1_score': array([0.571, 0.651, 0.477, 0.723, 0.656, 0.653]), 'precision': array([0.667, 0.562, 0.500, 0.793, 0.778, 0.636]), 'recall': array([0.500, 0.772, 0.455, 0.664, 0.568, 0.671]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.621850771252528, 'avg_precision': 0.6560694198654063, 'avg_recall': 0.6050252790584397, 'accuracy': 0.628, 'epoch': 62.0, 'f_d_global_step': 2604}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.636 Current is: 0.628

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/f_d_0.1_0.1_5/checkpoints/hls-model-2604

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/f_d_0.1_0.1_5/checkpoints/f_d/best.ckpt-1302


========== epoch : 4 ============

cost: 1.6963969864307382e-05

patience: 4


metrics_dict:  {'f1_score_1': 0.6458333333333333, 'precision_1': 0.5636363636363636, 'recall_1': 0.7560975609756098, 'support_1': 123, 'f1_score': array([0.615, 0.646, 0.475, 0.710, 0.656, 0.645]), 'precision': array([0.800, 0.564, 0.486, 0.789, 0.778, 0.620]), 'recall': array([0.500, 0.756, 0.464, 0.645, 0.568, 0.671]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.6245151059286784, 'avg_precision': 0.6727562505452012, 'avg_recall': 0.600773044165961, 'accuracy': 0.622, 'epoch': 63.0, 'f_d_global_step': 2646}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.636 Current is: 0.622

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/f_d_0.1_0.1_5/checkpoints/hls-model-2646

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/f_d_0.1_0.1_5/checkpoints/f_d/best.ckpt-1302


========== epoch : 5 ============

cost: 1.6382005025575157e-05

patience: 5


metrics_dict:  {'f1_score_1': 0.647887323943662, 'precision_1': 0.5714285714285714, 'recall_1': 0.7479674796747967, 'support_1': 123, 'f1_score': array([0.615, 0.648, 0.477, 0.704, 0.656, 0.636]), 'precision': array([0.800, 0.571, 0.482, 0.787, 0.778, 0.605]), 'recall': array([0.500, 0.748, 0.473, 0.636, 0.568, 0.671]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.6228134401848483, 'avg_precision': 0.6704132760936755, 'avg_recall': 0.5993909743387692, 'accuracy': 0.62, 'epoch': 64.0, 'f_d_global_step': 2688}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.636 Current is: 0.62

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/f_d_0.1_0.1_5/checkpoints/hls-model-2688

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/f_d_0.1_0.1_5/checkpoints/f_d/best.ckpt-1302


========== epoch : 6 ============

cost: 1.3410906322384279e-05

patience: 6


metrics_dict:  {'f1_score_1': 0.6413793103448275, 'precision_1': 0.5568862275449101, 'recall_1': 0.7560975609756098, 'support_1': 123, 'f1_score': array([0.615, 0.641, 0.468, 0.697, 0.656, 0.641]), 'precision': array([0.800, 0.557, 0.481, 0.784, 0.778, 0.613]), 'recall': array([0.500, 0.756, 0.455, 0.627, 0.568, 0.671]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.619732734462169, 'avg_precision': 0.6687311649808825, 'avg_recall': 0.5962546458975627, 'accuracy': 0.616, 'epoch': 65.0, 'f_d_global_step': 2730}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.636 Current is: 0.616

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/f_d_0.1_0.1_5/checkpoints/hls-model-2730

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/f_d_0.1_0.1_5/checkpoints/f_d/best.ckpt-1302

Optimization Finished for f_d!
